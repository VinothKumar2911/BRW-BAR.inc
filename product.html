<!DOCTYPE html>
<html>
<head>
    <title>Product</title>
    <link rel="stylesheet" href="product.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</head>

<body>

    <!-- NAVBAR -->
    <div class="navbar">
        <div class="navbar-links">
            <a href="RoughWork.html">Home</a>
            <a href="product.html">Products</a>
            <a href="About.html">About</a>
            <a href="cart.html">Cart <i class="fa-solid fa-cart-shopping"><sup class="cart-count">0</sup></i></a>
        </div>
    </div>

    <!-- HERO SECTION -->
    <div class="container1">
        <div class="c1right"><img src="img/img11.jpg"></div>
        <div class="c1left">
            <h1>Incredible Prices on <span>Your Favorite Items</span></h1>
            <p>Get more for less on selected brands</p>
            <button><i>Shop Now</i></button>
        </div>
    </div>
<br>
    <br>
    <br><br>
    <br>
    <br>
    <div class="container2">
        <img src="img/img12.jpg">
        <p>Lorem ipsum dolor sit amet consectetur adipisicing elit.</p>
    </div>

    <div class="container3">
        <p>"Makeup is art, <span>beauty is spirit</span>, together they create magic."</p>
    </div>
    <br>
    <br>
    <br>

    <div class="container5">
        <div class="c5left">
            <img src="img/img18.jpg">
            <h1>Unlock Your Potential â€“ <br><span>Empowering You</span> Every Step of the Way!</h1>
        </div>
        <div class="c5right"><img src="img/img17.jpg"></div>
    </div><br>
    <br>
    <br>

    <!-- PRODUCT LIST -->
    <div id="product-list"
         style="display:grid;grid-template-columns:repeat(4,1fr);gap:25px;width:90%;margin:50px auto;">
    </div>

<script>
/* ---------------- LOAD PRODUCTS ---------------- */
async function loadProducts() {
    const res = await fetch("http://localhost:5000/products");
    const products = await res.json();

    const container = document.getElementById("product-list");
    container.innerHTML = "";

    products.forEach(p => {
        container.innerHTML += `
            <div style="
                background:#fff;border-radius:12px;padding:15px;
                box-shadow:0 4px 10px rgba(0,0,0,0.1);
                display:flex;flex-direction:column;justify-content:space-between;height:430px;">
                
                <img src="${p.image}" style="width:100%;height:230px;object-fit:cover;border-radius:10px;">
                
                <div style="flex-grow:1;margin-top:10px;">
                    <h3 style="font-size:18px;color:#222;font-weight:bold;margin:0;">${p.name}</h3>
                    <p style="font-size:14px;color:#666;margin:5px 0 10px;">${p.description}</p>
                    <p style="font-size:18px;font-weight:bold;margin:0;">â‚¹${p.price}</p>
                </div>

                <button onclick="addToCart('${p.name}', ${p.price}, '${p.image}')"
                    style="width:100%;padding:10px;background:black;color:white;border:none;border-radius:6px;margin-top:10px;
                    cursor:pointer;">Add to Cart</button>
            </div>
        `;
    });
}

window.onload = loadProducts;

/* ---------------- ADD TO CART (LOCAL STORAGE) ---------------- */
function addToCart(name, price, image) {
    let cart = JSON.parse(localStorage.getItem("cart") || "[]");

    let existing = cart.find(p => p.name === name);

    if (existing) {
        existing.qty++;
    } else {
        cart.push({ name, price, image, qty: 1 });
    }

    localStorage.setItem("cart", JSON.stringify(cart));

    document.querySelector(".cart-count").innerText =
        cart.reduce((a, b) => a + b.qty, 0);

    alert(name + " added to cart!");
}
</script>


    <!-- VIDEO SECTION -->
    <div class="video-container">
        <video class="video" autoplay>
            <source src="vid/vid2.mp4" type="video/mp4">
        </video>
        <div class="overlay-text">Beauty begins the moment you decide to be yourself</div>
    </div>

    <!-- AI IMAGE ANALYZER -->
    <div class="ai-box">
        <h2>AI Image Analyzer</h2>
        <input type="file" id="imageInput" accept="image/*">
        <button onclick="analyzeImage()">Analyze Image</button>
        <p id="aiResult">Upload an image and click analyze.</p>
    </div>

<script>
async function analyzeImage() {
    const file = document.getElementById("imageInput").files[0];
    if (!file) return alert("Please upload an image.");

    document.getElementById("aiResult").innerHTML = "Analyzing image...";

    const base64 = await toBase64(file);
    const clean = base64.split(",")[1];

    const res = await fetch("http://localhost:5000/ai/analyze-image", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ image: clean })
    });

    const data = await res.json();

    if (data[0]?.generated_text)
        document.getElementById("aiResult").innerHTML = "AI Description: " + data[0].generated_text;
    else
        document.getElementById("aiResult").innerHTML = "AI could not describe this image.";
}

function toBase64(file) {
    return new Promise((res, rej) => {
        const reader = new FileReader();
        reader.onload = () => res(reader.result);
        reader.onerror = rej;
        reader.readAsDataURL(file);
    });
}
</script>


    <!-- CHATBOT -->
    <div class="chat-toggle" onclick="toggleChat()">ðŸ’¬ Chat</div>

    <div class="chat-box" id="chatBox">
        <div class="chat-header">Beauty AI Assistant</div>
        <div id="chatMessages"></div>
        <div class="typing" id="typingIndicator" style="display:none;">Bot is typing...</div>
        <div class="chat-input-area">
            <input id="chatInput" placeholder="Type your message..." onkeydown="handleKey(event)">
            <button onclick="sendMessage()">âž¤</button>
        </div>
    </div>

<script>
function toggleChat() {
    const box = document.getElementById("chatBox");
    box.style.display = box.style.display === "flex" ? "none" : "flex";
}

function handleKey(e) { if (e.key === "Enter") sendMessage(); }

function sendMessage() {
    const input = document.getElementById("chatInput").value.trim();
    if (!input) return;

    addMessage(input, "user");
    document.getElementById("chatInput").value = "";

    showTyping(true);

    setTimeout(() => {
        const reply = getBotReply(input.toLowerCase());
        showTyping(false);
        addMessage(reply, "bot");
    }, 900);
}

function addMessage(text, type) {
    const msgBox = document.getElementById("chatMessages");
    const msg = document.createElement("div");
    msg.className = type;
    msg.innerText = text;
    msgBox.appendChild(msg);
    msgBox.scrollTop = msgBox.scrollHeight;
}

function showTyping(s) {
    document.getElementById("typingIndicator").style.display = s ? "block" : "none";
}

function getBotReply(q) {
    const data = [
        { t: "lipstick", r: "Matte lipsticks last longer. Want shade suggestions?" },
        { t: "foundation", r: "Choose foundation based on skin type & undertone." },
        { t: "serum", r: "Vitamin C brightens; Niacinamide reduces pores." },
        { t: "oily", r: "Use oil-free matte products." },
        { t: "dry", r: "Use hydrating moisturizers." }
    ];

    for (let x of data)
        if (q.includes(x.t)) return x.r;

    return "Ask me anything about beauty, makeup or skincare!";
}
</script>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <h3>Stay Connected</h3>
                <div class="social-icons">
                    <i class="fab fa-facebook-f"></i>
                    <i class="fab fa-twitter"></i>
                    <i class="fab fa-instagram"></i>
                </div>
            </div>
        </div>
    </footer>


    <!-- REVIEW ANALYZER -->
    <textarea id="reviewBox" placeholder="Write your review..." 
        style="width:100%;height:80px;margin-top:20px;"></textarea>

    <button onclick="analyzeReview()" 
        style="padding:10px 20px;background:black;color:white;border:none;margin-top:10px;">
        Analyze Review
    </button>

<script>
async function analyzeReview() {
    const reviewText = document.getElementById("reviewBox").value;

    if (!reviewText.trim()) return alert("Please write a review.");

    try {
        const res = await fetch("http://localhost:5000/ai/analyze", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ review: reviewText })
        });

        const data = await res.json();

        if (!data.success) {
            alert(data.message);
            return;
        }

        alert(`Sentiment: ${data.sentiment.toUpperCase()} (Score: ${data.score})`);

    } catch (err) {
        alert("Server error");
        console.error(err);
    }
}
</script>

</body>
</html>
